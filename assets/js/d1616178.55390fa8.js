"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7927,816],{3258:(e,t,s)=>{s.r(t),s.d(t,{default:()=>r});var a=s(6540),n=s(6430),l=s(2905),i=s(4848);const r=e=>{let{employees:t,handleEdit:s,handleEditWishlist:r,handleDelete:c,isAdmin:d,getGenerationList:x,familyTree:o}=e;const[m,p]=(0,a.useState)({}),[h,g]=(0,a.useState)({}),[y,u]=(0,a.useState)({}),[f,b]=(0,a.useState)({});(0,a.useEffect)((()=>{(async()=>{const e={},t={};(await(0,n.GG)((0,n.rJ)(l.db,"names02"))).forEach((s=>{const a=s.data();e[s.id]=a.name||"Unknown",t[s.id]={id:s.id,...a}})),u(e),b(t)})()}),[]);return(0,i.jsx)("div",{className:"flex justify-center mt-6",children:(0,i.jsxs)("table",{className:"table-auto",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{className:"bg-gray-100 border-b",children:[(0,i.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Name"}),(0,i.jsx)("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-700",children:"Your Wishlist"}),(0,i.jsx)("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-700",children:"Edit Wishlist"}),(0,i.jsx)("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-700",children:"Pick"}),(0,i.jsx)("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-700",children:"Pick's Wishlist"}),d&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Pick ID "}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Parents"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Spouse"}),(0,i.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium text-gray-700",children:"Generation"}),(0,i.jsx)("th",{className:"px-6 py-3 text-center text-sm font-medium text-gray-700",children:"Actions"})]})]})}),(0,i.jsx)("tbody",{children:t&&t.length>0?t.map(((e,t)=>(0,i.jsxs)("tr",{className:(t%2==0?"bg-white":"bg-gray-50")+" hover:bg-gray-100 border-b",children:[(0,i.jsx)("td",{className:"px-6 py-4 text-left text-gray-600",children:e.name}),(0,i.jsx)("td",{className:"px-2 py-2 text-left text-gray-600",children:f[e.id]?.wishlist}),(0,i.jsx)("td",{className:"px-2 py-2 text-center",children:(0,i.jsx)("button",{onClick:()=>r(e.id),className:"px-3 py-1 text-sm text-white bg-green-500 rounded-lg hover:bg-green-600",children:"Edit Wishlist"})}),(0,i.jsx)("td",{className:"px-6 py-4 text-center text-gray-600",children:""===e.pick?m[e.name]?m[e.name]:h[e.name]?h[e.name]:(0,i.jsx)("button",{className:"px-3 py-1 text-sm text-white bg-blue-500 rounded-lg hover:bg-blue-600",onClick:()=>(async(e,t)=>{const s=x(e,o).filter((t=>t!==e)),a=((e,t)=>e.filter((e=>e.pick&&""!==e.pick.trim())).map((e=>t[e.pick]||e.pick)))(o,y),i=((e,t)=>{const s=t.find((t=>t.name===e));if(!s||!s.spouse)return[];const a=t.find((e=>e.id===s.spouse));return a?[a.name]:[]})(e,o),r=((e,t)=>{const s=t.find((t=>t.name===e));if(!s||!s.parents_a)return[];const a=s.parents_a;return t.filter((t=>t.parents_a===a&&t.name!==e)).map((e=>e.name))})(e,o),c=(e=>e.filter((e=>!1===e.bunot)).map((e=>e.name)))(o),d=o.find((e=>e.id===t)),m=d?d.generation:null,h=((e,t,s,a,n,l)=>e.filter((e=>!(t.includes(e)||s.includes(e)||n.includes(e)||2!==l&&a.includes(e)))))(s,i,a,r,c,m);if(console.log("wee"),console.log("generation",s),console.log("picked",a),console.log("spouse",i),console.log("sibling",r),console.log("noBonut",c),console.log("eligible",h),h.length>0){const a=h[Math.floor(Math.random()*h.length)],i=(0,n.P)((0,n.rJ)(l.db,"names02"),(0,n._M)("name","==",a)),r=(await(0,n.GG)(i)).docs[0],c={id:r.id,...r.data()};console.log(c);let d=0;const x=setInterval((()=>{g((t=>({...t,[e]:s[d%s.length]}))),d+=1}),100);setTimeout((async()=>{clearInterval(x),g((t=>({...t,[e]:null}))),p((t=>({...t,[e]:c.name}))),console.log("Picked Name:",c.name);try{const e=(0,n.H9)(l.db,"names02",t);await(0,n.BN)(e,{pick:c.id},{merge:!0}),console.log(`Updated Firestore with picked person ID: ${c.id}`)}catch(s){console.error("Error updating Firestore:",s)}}),3e3)}else console.log("No eligible names available to pick.")})(e.name,e.id),children:"Bunot"}):y[e.pick]||e.pick}),(0,i.jsx)("td",{className:"px-6 py-4 text-center text-gray-600",children:f[e.pick]?.wishlist}),d&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("td",{className:"px-2 py-2 text-left text-gray-600",children:e.id}),(0,i.jsx)("td",{className:"px-2 py-2 text-left text-gray-600",children:e.parents_a}),(0,i.jsx)("td",{className:"px-2 py-2 text-left text-gray-600",children:e.spouse}),(0,i.jsx)("td",{className:"px-2 py-2 text-left text-gray-600",children:e.generation}),(0,i.jsxs)("td",{className:"px-2 py-2 text-center",children:[(0,i.jsx)("button",{onClick:()=>s(e.id),className:"px-3 py-1 text-sm text-gray-600 bg-gray-200 rounded-lg hover:bg-gray-300",children:"Edit"}),(0,i.jsx)("button",{onClick:()=>c(e.id),className:"px-3 py-1 text-sm text-gray-600 bg-red-200 rounded-lg hover:bg-red-300",children:"Delete"})]})]})]},e.id))):(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:d?7:2,className:"px-6 py-4 text-center text-gray-600",children:"."})})})]})})}},2905:(e,t,s)=>{s.r(t),s.d(t,{db:()=>i,default:()=>r});var a=s(223),n=s(6430);const l=(0,a.Wp)({apiKey:"AIzaSyBD2yUpGVaZw6N9x6iex8pbJx20cqA-EK0",authDomain:"employee-database-861a6.firebaseapp.com",projectId:"employee-database-861a6",storageBucket:"employee-database-861a6.appspot.com",messagingSenderId:"69607313080",appId:"1:69607313080:web:99a0f1e74c4fa5c66eae4d"}),i=(0,n.aU)(l),r=l}}]);